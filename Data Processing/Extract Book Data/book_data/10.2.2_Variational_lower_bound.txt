We can also straightforwardly evaluate the lower bound (10.3) for this model.
In practice, it is useful to be able to monitor the bound during the re-estimation in
order to test for convergence. It can also provide a valuable check on both the math-
ematical expressions for the solutions and their software implementation, because at
each step of the iterative re-estimation procedure the value of this bound should not
decrease. We can take this a stage further to provide a deeper test of the correctness
of both the mathematical derivation of the update equations and of their software im-
plementation by using finite differences to check that each update does indeed give
a (constrained) maximum of the bound (Svens´en and Bishop, 2004).
For the variational mixture of Gaussians, the lower bound (10.3) is given by
L =
q(Z, π, µ, Λ) ln
p(X, Z, π, µ, Λ)
dπ dµ dΛ
Z
q(Z, π, µ, Λ)
= E[ln p(X, Z, π, µ, Λ)] − E[ln q(Z, π, µ, Λ)]
= E[ln p(X|Z, µ, Λ)] + E[ln p(Z|π)] + E[ln p(π)] + E[ln p(µ, Λ)]
−E[ln q(Z)] − E[ln q(π)] − E[ln q(µ, Λ)]
(10.70)
where, to keep the notation uncluttered, we have omitted the  superscript on the
q distributions, along with the subscripts on the expectation operators because each
expectation is taken with respect to all of the random variables in its argument. The
various terms in the bound are easily evaluated to give the following results
E[ln p(X|Z, µ, Λ)] =
Nk
ln
Λk − Dβ−1
k − νkTr(SkWk)
1
2
−νk(xk − mk)TWk(xk − mk) − D ln(2π)
E[ln p(Z|π)] =
n=1
k=1
rnk ln
πk
E[ln p(π)] = ln C(α0) + (α0 − 1)
ln
k=1
πk
(10.71)
(10.72)
(10.73)
Λk −
Dβ0
βk
k=1
K
1
2
ln
k=1
k=1
k=1
K
K
n=1
k=1
k=1
2
K
K
N
b
z
482
10. APPROXIMATE INFERENCE
E[ln p(µ, Λ)] =
D ln(β0/2π) + ln
1
2
−β0νk(mk − m0)TWk(mk − m0)
(ν0 − D − 1)
ln
K
Λk −
1
2
νkTr(W−1
0 Wk)
+ K ln B(W0, ν0)
(10.74)
(10.75)
(10.76)
(10.77)
E[ln q(Z)] =
rnk ln rnk
E[ln q(π)] =
(αk − 1) ln
πk + ln C(α)
E[ln q(µ, Λ)] =
Λk + D
2
ln
βk
2π
D
2 − H [q(Λk)]
where D is the dimensionality of x, H[q(Λk)] is the entropy of the Wishart distribu-
tion given by (B.82), and the coefficients C(α) and B(W, ν) are defined by (B.23)
and (B.79), respectively. Note that the terms involving expectations of the logs of the
q distributions simply represent the negative entropies of those distributions. Some
simplifications and combination of terms can be performed when these expressions
are summed to give the lower bound. However, we have kept the expressions sepa-
rate for ease of understanding.
Finally, it is worth noting that the lower bound provides an alternative approach
for deriving the variational re-estimation equations obtained in Section 10.2.1. To do
this we use the fact that, since the model has conjugate priors, the functional form of
the factors in the variational posterior distribution is known, namely discrete for Z,
Dirichlet for π, and Gaussian-Wishart for (µk, Λk). By taking general parametric
forms for these distributions we can derive the form of the lower bound as a function
of the parameters of the distributions. Maximizing the bound with respect to these
parameters then gives the required re-estimation equations.
