explain how this may be combined with the Metropolis algorithm to yield the pow-
erful hybrid Monte Carlo algorithm. A background in physics is not required as this
section is self-contained and the key results are all derived from first principles.
11.5.1 Dynamical systems
The dynamical approach to stochastic sampling has its origins in algorithms for
simulating the behaviour of physical systems evolving under Hamiltonian dynam-
ics. In a Markov chain Monte Carlo simulation, the goal is to sample from a given
probability distribution p(z). The framework of Hamiltonian dynamics is exploited
by casting the probabilistic simulation in the form of a Hamiltonian system. In order
to remain in keeping with the literature in this area, we make use of the relevant
dynamical systems terminology where appropriate, which will be defined as we go
along.
The dynamics that we consider corresponds to the evolution of the state variable
z = {zi} under continuous time, which we denote by τ . Classical dynamics is de-
scribed by Newton’s second law of motion in which the acceleration of an object is
proportional to the applied force, corresponding to a second-order differential equa-
tion over time. We can decompose a second-order equation into two coupled first-
order equations by introducing intermediate momentum variables r, corresponding
to the rate of change of the state variables z, having components
ri =
dzi
dτ
(11.53)
where the zi can be regarded as position variables in this dynamics perspective. Thus
where E(z) is interpreted as the potential energy of the system when in state z. The
system acceleration is the rate of change of momentum and is given by the applied
force, which itself is the negative gradient of the potential energy
dri
dτ
∂E(z)
∂zi
(11.54)
(11.55)
11.5. The Hybrid Monte Carlo Algorithm
549
for each position variable there is a corresponding momentum variable, and the joint
space of position and momentum variables is called phase space.
Without loss of generality, we can write the probability distribution p(z) in the
form
p(z) =
1
Zp
exp (−E(z))
It is convenient to reformulate this dynamical system using the Hamiltonian
framework. To do this, we first define the kinetic energy by
K(r) =
1
2r2 =
1
2
r2
i .
i
(11.56)
The total energy of the system is then the sum of its potential and kinetic energies
H(z, r) = E(z) + K(r)
(11.57)
Exercise 11.15
where H is the Hamiltonian function. Using (11.53), (11.55), (11.56), and (11.57),
we can now express the dynamics of the system in terms of the Hamiltonian equa-
tions given by
dzi
dτ
dri
dτ
= ∂H
∂ri
∂H
∂zi
(11.58)
(11.59)
William Hamilton
1805–1865
William Rowan Hamilton was an
Irish mathematician and physicist,
and child prodigy, who was ap-
pointed Professor of Astronomy at
Trinity College, Dublin, in 1827, be-
fore he had even graduated. One
of Hamilton’s most important contributions was a new
formulation of dynamics, which played a significant
role in the later development of quantum mechanics.
His other great achievement was the development of
quaternions, which generalize the concept of complex
numbers by introducing three distinct square roots of
minus one, which satisfy i2 = j2 = k2 = ijk = −1.
It is said that these equations occurred to him while
walking along the Royal Canal in Dublin with his wife,
on 16 October 1843, and he promptly carved the
equations into the side of Broome bridge. Although
there is no longer any evidence of the carving, there is
now a stone plaque on the bridge commemorating the
discovery and displaying the quaternion equations.
i
i
i
550
11. SAMPLING METHODS
During the evolution of this dynamical system, the value of the Hamiltonian H is
constant, as is easily seen by differentiation
∂H
∂zi
dzi
dτ
+ ∂H
∂ri
dri
dτ
dH
dτ
∂H
∂zi
∂H
∂ri −
∂H
∂ri
∂H
∂zi
= 0.
(11.60)
A second important property of Hamiltonian dynamical systems, known as Li-
ouville’s Theorem, is that they preserve volume in phase space. In other words, if
we consider a region within the space of variables (z, r), then as this region evolves
under the equations of Hamiltonian dynamics, its shape may change but its volume
will not. This can be seen by noting that the flow field (rate of change of location in
phase space) is given by
dz
dτ
and that the divergence of this field vanishes
V =
dr
dτ
(11.61)
div V =
∂zi
dzi
dτ
dri
dτ
∂ri
∂ri
i
∂zi
∂H
∂ri
∂H
∂zi
= 0.
(11.62)
Now consider the joint distribution over phase space whose total energy is the
Hamiltonian, i.e., the distribution given by
p(z, r) =
1
ZH
exp(−H(z, r)).
(11.63)
Using the two results of conservation of volume and conservation of H, it follows
that the Hamiltonian dynamics will leave p(z, r) invariant. This can be seen by
considering a small region of phase space over which H is approximately constant.
If we follow the evolution of the Hamiltonian equations for a finite time, then the
volume of this region will remain unchanged as will the value of H in this region, and
hence the probability density, which is a function only of H, will also be unchanged.
Although H is invariant, the values of z and r will vary, and so by integrating
the Hamiltonian dynamics over a finite time duration it becomes possible to make
large changes to z in a systematic way that avoids random walk behaviour.
Evolution under the Hamiltonian dynamics will not, however, sample ergodi-
cally from p(z, r) because the value of H is constant. In order to arrive at an ergodic
sampling scheme, we can introduce additional moves in phase space that change
the value of H while also leaving the distribution p(z, r) invariant. The simplest
way to achieve this is to replace the value of r with one drawn from its distribution
conditioned on z. This can be regarded as a Gibbs sampling step, and hence from
Exercise 11.16
11.5. The Hybrid Monte Carlo Algorithm
551
Section 11.3 we see that this also leaves the desired distribution invariant. Noting
that z and r are independent in the distribution p(z, r), we see that the conditional
distribution p(r|z) is a Gaussian from which it is straightforward to sample.
In a practical application of this approach, we have to address the problem of
performing a numerical integration of the Hamiltonian equations. This will neces-
sarily introduce numerical errors and so we should devise a scheme that minimizes
the impact of such errors. In fact, it turns out that integration schemes can be devised
for which Liouville’s theorem still holds exactly. This property will be important in
