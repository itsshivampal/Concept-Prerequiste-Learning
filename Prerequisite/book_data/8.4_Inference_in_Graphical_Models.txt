Figure 8.35 A directed graph whose conditional
independence
properties cannot be expressed using an undirected
graph over the same three variables.
A
393
B
C
that distribution. A perfect map is therefore both an I map and a D map.
Consider the set of distributions such that for each distribution there exists a
directed graph that is a perfect map. This set is distinct from the set of distributions
such that for each distribution there exists an undirected graph that is a perfect map.
In addition there are distributions for which neither directed nor undirected graphs
offer a perfect map. This is illustrated as a Venn diagram in Figure 8.34.
Figure 8.35 shows an example of a directed graph that is a perfect map for
a distribution satisfying the conditional independence properties A ⊥⊥ B | ∅ and
A ⊥⊥ B | C. There is no corresponding undirected graph over the same three vari-
ables that is a perfect map.
Conversely, consider the undirected graph over four variables shown in Fig-
ure 8.36. This graph exhibits the properties A ⊥⊥ B | ∅, C ⊥⊥ D | A ∪ B and
A ⊥⊥ B | C ∪ D. There is no directed graph over four variables that implies the same
set of conditional independence properties.
The graphical framework can be extended in a consistent way to graphs that
include both directed and undirected links. These are called chain graphs (Lauritzen
and Wermuth, 1989; Frydenberg, 1990), and contain the directed and undirected
graphs considered so far as special cases. Although such graphs can represent a
broader class of distributions than either directed or undirected alone, there remain
distributions for which even a chain graph cannot provide a perfect map. Chain
graphs are not discussed further in this book.
Figure 8.36 An undirected graph whose conditional
independence
properties cannot be expressed in terms of a directed
graph over the same variables.
A
B
C
D
8.4.
Inference in Graphical Models
We turn now to the problem of inference in graphical models, in which some of
the nodes in a graph are clamped to observed values, and we wish to compute the
posterior distributions of one or more subsets of other nodes. As we shall see, we
can exploit the graphical structure both to find efficient algorithms for inference, and
394
8. GRAPHICAL MODELS
Figure 8.37 A graphical representation of Bayes’
See the text for details.
theorem.
x
y
x
y
x
y
(a)
(b)
(c)
to make the structure of those algorithms transparent. Specifically, we shall see that
many algorithms can be expressed in terms of the propagation of local messages
around the graph. In this section, we shall focus primarily on techniques for exact
inference, and in Chapter 10 we shall consider a number of approximate inference
algorithms.
To start with, let us consider the graphical interpretation of Bayes’ theorem.
Suppose we decompose the joint distribution p(x, y) over two variables x and y into
a product of factors in the form p(x, y) = p(x)p(y|x). This can be represented by
the directed graph shown in Figure 8.37(a). Now suppose we observe the value of
y, as indicated by the shaded node in Figure 8.37(b). We can view the marginal
distribution p(x) as a prior over the latent variable x, and our goal is to infer the
corresponding posterior distribution over x. Using the sum and product rules of
probability we can evaluate
p(y) =
p(y|x)p(x)
x
which can then be used in Bayes’ theorem to calculate
p(x|y) = p(y|x)p(x)
p(y)
(8.47)
(8.48)
Thus the joint distribution is now expressed in terms of p(y) and p(x|y). From a
graphical perspective, the joint distribution p(x, y) is now represented by the graph
shown in Figure 8.37(c), in which the direction of the arrow is reversed. This is the
simplest example of an inference problem for a graphical model.
